<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<title>Network Services API: SNTP Client</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="tiapistylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<table width="100%">
<tr>
  <td bgcolor="black" width="1"><a href="http://www.ti.com"><img border="0" src="tilogo.gif" /></a></td>
  <td bgcolor="red"><img src="titagline.gif" /></td>
</tr>
</table>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Network Services API
   &#160;<span id="projectnumber">1.40.00.04</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">SNTP Client</div>  </div>
</div><!--header-->
<div class="contents">

<p>SNTP Client API.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga071a1a73a48295420c6efd7d3f5e041c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ti__net__sntp__SNTP.html#ga071a1a73a48295420c6efd7d3f5e041c">SNTP_getTime</a> (struct sockaddr *server, uint32_t(*get)(void), void(*set)(uint32_t newtime))</td></tr>
<tr class="memdesc:ga071a1a73a48295420c6efd7d3f5e041c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get time from NTP server.  <a href="#ga071a1a73a48295420c6efd7d3f5e041c">More...</a><br /></td></tr>
<tr class="separator:ga071a1a73a48295420c6efd7d3f5e041c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
SNTP Error Codes</h2></td></tr>
<tr class="memitem:ga833bfbd9a170df1f81da629e5cd91845"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ti__net__sntp__SNTP.html#ga833bfbd9a170df1f81da629e5cd91845">SNTP_EINVALIDARGS</a>&#160;&#160;&#160;(-101)</td></tr>
<tr class="memdesc:ga833bfbd9a170df1f81da629e5cd91845"><td class="mdescLeft">&#160;</td><td class="mdescRight">Input arguments are invalid.  <a href="#ga833bfbd9a170df1f81da629e5cd91845">More...</a><br /></td></tr>
<tr class="separator:ga833bfbd9a170df1f81da629e5cd91845"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae875a69accd1fd0c46adda637523f83b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ti__net__sntp__SNTP.html#gae875a69accd1fd0c46adda637523f83b">SNTP_ESOCKETFAIL</a>&#160;&#160;&#160;(-102)</td></tr>
<tr class="memdesc:gae875a69accd1fd0c46adda637523f83b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Failed to create a socket.  <a href="#gae875a69accd1fd0c46adda637523f83b">More...</a><br /></td></tr>
<tr class="separator:gae875a69accd1fd0c46adda637523f83b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga969984141cc5f01210c7ad1a28caf8de"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ti__net__sntp__SNTP.html#ga969984141cc5f01210c7ad1a28caf8de">SNTP_EINVALIDFAMILY</a>&#160;&#160;&#160;(-103)</td></tr>
<tr class="memdesc:ga969984141cc5f01210c7ad1a28caf8de"><td class="mdescLeft">&#160;</td><td class="mdescRight">The input socket address is not of AF_INET (IPv4) or AF_INET6 (IPv6) family type.  <a href="#ga969984141cc5f01210c7ad1a28caf8de">More...</a><br /></td></tr>
<tr class="separator:ga969984141cc5f01210c7ad1a28caf8de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga794dd2952888823587e85264a8525884"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ti__net__sntp__SNTP.html#ga794dd2952888823587e85264a8525884">SNTP_ESOCKETOPTFAIL</a>&#160;&#160;&#160;(-104)</td></tr>
<tr class="memdesc:ga794dd2952888823587e85264a8525884"><td class="mdescLeft">&#160;</td><td class="mdescRight">Failed to set receive timeout on socket.  <a href="#ga794dd2952888823587e85264a8525884">More...</a><br /></td></tr>
<tr class="separator:ga794dd2952888823587e85264a8525884"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa2b08acea154cad301a43daf65eec489"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ti__net__sntp__SNTP.html#gaa2b08acea154cad301a43daf65eec489">SNTP_ECONNECTFAIL</a>&#160;&#160;&#160;(-105)</td></tr>
<tr class="memdesc:gaa2b08acea154cad301a43daf65eec489"><td class="mdescLeft">&#160;</td><td class="mdescRight">Failed to connect to the NTP server.  <a href="#gaa2b08acea154cad301a43daf65eec489">More...</a><br /></td></tr>
<tr class="separator:gaa2b08acea154cad301a43daf65eec489"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaffe13e69ec9483c742560a774243da90"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ti__net__sntp__SNTP.html#gaffe13e69ec9483c742560a774243da90">SNTP_ESENDFAIL</a>&#160;&#160;&#160;(-106)</td></tr>
<tr class="memdesc:gaffe13e69ec9483c742560a774243da90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Failed to send a time request to the NTP server.  <a href="#gaffe13e69ec9483c742560a774243da90">More...</a><br /></td></tr>
<tr class="separator:gaffe13e69ec9483c742560a774243da90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac831a16869b7c78c044b8b92b2b85973"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ti__net__sntp__SNTP.html#gac831a16869b7c78c044b8b92b2b85973">SNTP_ERECVFAIL</a>&#160;&#160;&#160;(-107)</td></tr>
<tr class="memdesc:gac831a16869b7c78c044b8b92b2b85973"><td class="mdescLeft">&#160;</td><td class="mdescRight">Failed to recieve the new time from the NTP server.  <a href="#gac831a16869b7c78c044b8b92b2b85973">More...</a><br /></td></tr>
<tr class="separator:gac831a16869b7c78c044b8b92b2b85973"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac6ff9ea6bae8596e917cc34725190f67"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ti__net__sntp__SNTP.html#gac6ff9ea6bae8596e917cc34725190f67">SNTP_ERATEBACKOFF</a>&#160;&#160;&#160;(-108)</td></tr>
<tr class="memdesc:gac6ff9ea6bae8596e917cc34725190f67"><td class="mdescLeft">&#160;</td><td class="mdescRight">NTP Server requests to reduce the update rate (RFC 5905 kiss code RATE)  <a href="#gac6ff9ea6bae8596e917cc34725190f67">More...</a><br /></td></tr>
<tr class="separator:gac6ff9ea6bae8596e917cc34725190f67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6e874080da6108182e1aa5047031ef7d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ti__net__sntp__SNTP.html#ga6e874080da6108182e1aa5047031ef7d">SNTP_EFATALNORETRY</a>&#160;&#160;&#160;(-109)</td></tr>
<tr class="memdesc:ga6e874080da6108182e1aa5047031ef7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">NTP Server invalid or server requests to end all communications (RFC 5905 kiss code DENY or RSTR)  <a href="#ga6e874080da6108182e1aa5047031ef7d">More...</a><br /></td></tr>
<tr class="separator:ga6e874080da6108182e1aa5047031ef7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>SNTP Client API. </p>
<p>The SNTP client provides an API to synchronize the local system clock with a server that provides time synchronization services using Network Time Protocol (NTP).</p>
<h1>Prerequisites For Use</h1>
<p>To use the SNTP client service, the user is required to provide two system time keeping functions, as well as an NTP server's IP address.</p>
<p>Furthermore, the SNTP client has been written to conform to the BSD sockets support layer. As such, it is required that the file containing any calls to the SNTP client API conform to the BSD layer requirements.</p>
<h1>SNTP Client Time Functions</h1>
<p>The required time keeping functions are called by the SNTP client in order to get or set the current time in the system ("gettime" and "settime"). For example, these could be APIs which set or get the value of a Real Time Clock (RTC), such as the TI-RTOS Seconds module's Seconds_get() and Seconds_set() APIs. But, any equivalent API can be used.</p>
<p>The "gettime" and "settime" functions should have the following format: </p><div class="fragment"><div class="line">uint32_t (*GetTimeFxn)(void);</div><div class="line">void (*SetTimeFxn)(uint32_t newtime);</div></div><!-- fragment --><p>The "gettime" function should return the number of seconds since the Epoch (January 1, 1970). The "settime" function sets the time to the value that is passed to it. The SNTP client uses the "gettime" function to write the current system time into a request to an NTP server. The "settime" function is used to set the system time to a new value received from the NTP server. The SNTP client handles the conversion of NTP time (time since January 1, 1900) to the local system's time (number of seconds since January 1, 1970).</p>
<p>Both IPv4 and IPv6 unicast server addresses are supported (host names are not supported). Structures of type 'struct sockaddr_in' must be used for IPv4 server addresses and of type 'struct sockaddr_in6' for IPv6 server addresses.</p>
<h1>Important note on NTP protocol</h1>
<p>The NTP protocol clearly specifies that an SNTP client must never send requests to an NTP server in intervals less than 15 seconds. It is important to respect this NTP requirement and it is the user's responsibilty to ensure that <a class="el" href="group__ti__net__sntp__SNTP.html#ga071a1a73a48295420c6efd7d3f5e041c" title="Get time from NTP server. ">SNTP_getTime()</a> is not called more than once in any 15 second time period.</p>
<h1>Example Usage</h1>
<p>SNTP uses BSD Socket APIs by including &lt;ti/net/socket.h&gt; which conditionally includes the BSD socket headers for the various networking layers. It is necessary to ensure that the following define is passed to the compiler in the application build to include the correct network layer BSD headers:</p>
<p>For SimpleLink WiFi networking layer: -DNET_SL</p>
<p>For NDK networking layer: -DNET_NDK</p>
<p>To use the SNTP client APIs, the application should include its header file as follows: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="sntp_8h.html">ti/net/sntp/sntp.h</a>&gt;</span></div></div><!-- fragment --><p>And, to the link line add the following SNTP library:</p>
<p>For SimpleLink WiFi networking layer: -l{NS_INSTALL_DIR}/source/ti/net/sntp/lib/sntp_sl.a{target}</p>
<p>For NDK networking layer: -l{NS_INSTALL_DIR}/source/ti/net/sntp/lib/sntp_ndk.a{target} </p><hr/>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga833bfbd9a170df1f81da629e5cd91845"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga833bfbd9a170df1f81da629e5cd91845">&sect;&nbsp;</a></span>SNTP_EINVALIDARGS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SNTP_EINVALIDARGS&#160;&#160;&#160;(-101)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Input arguments are invalid. </p>

</div>
</div>
<a id="gae875a69accd1fd0c46adda637523f83b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae875a69accd1fd0c46adda637523f83b">&sect;&nbsp;</a></span>SNTP_ESOCKETFAIL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SNTP_ESOCKETFAIL&#160;&#160;&#160;(-102)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Failed to create a socket. </p>

</div>
</div>
<a id="ga969984141cc5f01210c7ad1a28caf8de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga969984141cc5f01210c7ad1a28caf8de">&sect;&nbsp;</a></span>SNTP_EINVALIDFAMILY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SNTP_EINVALIDFAMILY&#160;&#160;&#160;(-103)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The input socket address is not of AF_INET (IPv4) or AF_INET6 (IPv6) family type. </p>

</div>
</div>
<a id="ga794dd2952888823587e85264a8525884"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga794dd2952888823587e85264a8525884">&sect;&nbsp;</a></span>SNTP_ESOCKETOPTFAIL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SNTP_ESOCKETOPTFAIL&#160;&#160;&#160;(-104)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Failed to set receive timeout on socket. </p>

</div>
</div>
<a id="gaa2b08acea154cad301a43daf65eec489"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa2b08acea154cad301a43daf65eec489">&sect;&nbsp;</a></span>SNTP_ECONNECTFAIL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SNTP_ECONNECTFAIL&#160;&#160;&#160;(-105)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Failed to connect to the NTP server. </p>

</div>
</div>
<a id="gaffe13e69ec9483c742560a774243da90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaffe13e69ec9483c742560a774243da90">&sect;&nbsp;</a></span>SNTP_ESENDFAIL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SNTP_ESENDFAIL&#160;&#160;&#160;(-106)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Failed to send a time request to the NTP server. </p>

</div>
</div>
<a id="gac831a16869b7c78c044b8b92b2b85973"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac831a16869b7c78c044b8b92b2b85973">&sect;&nbsp;</a></span>SNTP_ERECVFAIL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SNTP_ERECVFAIL&#160;&#160;&#160;(-107)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Failed to recieve the new time from the NTP server. </p>

</div>
</div>
<a id="gac6ff9ea6bae8596e917cc34725190f67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac6ff9ea6bae8596e917cc34725190f67">&sect;&nbsp;</a></span>SNTP_ERATEBACKOFF</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SNTP_ERATEBACKOFF&#160;&#160;&#160;(-108)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>NTP Server requests to reduce the update rate (RFC 5905 kiss code RATE) </p>

</div>
</div>
<a id="ga6e874080da6108182e1aa5047031ef7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6e874080da6108182e1aa5047031ef7d">&sect;&nbsp;</a></span>SNTP_EFATALNORETRY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SNTP_EFATALNORETRY&#160;&#160;&#160;(-109)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>NTP Server invalid or server requests to end all communications (RFC 5905 kiss code DENY or RSTR) </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga071a1a73a48295420c6efd7d3f5e041c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga071a1a73a48295420c6efd7d3f5e041c">&sect;&nbsp;</a></span>SNTP_getTime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SNTP_getTime </td>
          <td>(</td>
          <td class="paramtype">struct sockaddr *&#160;</td>
          <td class="paramname"><em>server</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t(*)(void)&#160;</td>
          <td class="paramname"><em>get</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(uint32_t newtime)&#160;</td>
          <td class="paramname"><em>set</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get time from NTP server. </p>
<p>This function can be used to set the local time by providing the setters and getters of current time on system clock. It is the user's responsibility to periodically call this function to sync the time with NTP server. But note, the function should not be called more than once in a 15 second period to respect the NTP requirement.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">server</td><td>A pointer to a sockaddr_in or sockaddr_in6 structure containing NTP server address.</td></tr>
    <tr><td class="paramname">get</td><td>A pointer to a function that returns the number of seconds since January 1, 1970.</td></tr>
    <tr><td class="paramname">set</td><td>A pointer to a function that sets the time to the supplied value.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, or an error code on failure </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><small>
Copyright  2017, Texas Instruments Incorporated
</small>
</body>
</html>
